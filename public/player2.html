<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <script src="https://aframe.io/releases/1.0.3/aframe.min.js"></script>
    <script src="https://unpkg.com/aframe-environment-component@1.1.0/dist/aframe-environment-component.min.js"></script>
    <script src="./js/turnCheck.js"></script>
    <script src="/socket.io/socket.io.js"></script>
    <title>Player 2 Client</title>
</head>
<body>
    <a-scene>
        <a-entity environment="preset: forest; groundColor: #445; grid: cross"></a-entity>

        <a-camera look-controls wasd-controls="acceleration:100" position="0 1.6 0">
            <a-cursor></a-cursor>
        </a-camera>

        <a-sky color="#fff"></a-sky>
        <a-entity environment="preset: forest; groundColor: #445; grid: cross"></a-entity>
        <a-entity width="1" height="1" position="0 1 -3" id="block1" class="p2Block" geometry="primitive: box" material="color: grey" ></a-entity>
        <a-entity width="1" height="1" position="0 2.5 -3" id="block2" class="p2Block" geometry="primitive: box" material="color: grey" ></a-entity>
        <a-entity width="1" height="1" position="0 4 -3" id="block3" class="p2Block" geometry="primitive: box" material="color: grey" ></a-entity>
        <a-entity width="1" height="1" position="-2 1 -3" id="block4" class="p2Block" geometry="primitive: box" material="color: grey" ></a-entity>
        <a-entity width="1" height="1" position="-2 2.5 -3" id="block5" class="p2Block" geometry="primitive: box" material="color: grey" ></a-entity>
        <a-entity width="1" height="1" position="-2 4 -3" id="block6" class="p2Block" geometry="primitive: box" material="color: grey" ></a-entity>
        <a-entity width="1" height="1" position="2 1 -3" id="block7" class="p2Block" geometry="primitive: box" material="color: grey" ></a-entity>
        <a-entity width="1" height="1" position="2 2.5 -3" id="block8" class="p2Block" geometry="primitive: box" material="color: grey" ></a-entity>
        <a-entity width="1" height="1" position="2 4 -3" id="block9" class="p2Block" geometry="primitive: box" material="color: grey" ></a-entity>
        
        <a-entity width="1" height="1" position="4 2.5 -3" id="turnLight2" geometry="primitive: box" material="color: grey" ></a-entity>
        
        <a-plane material="color: #FFFFFF"  height="10" width="12" position="0 0.2 -3"></a-plane>
    </a-scene>

    <script>
        let socket = io();

        //default connect event
        socket.on('connect', function() {
        console.log("player2 connected!");
        });

        const p1 = document.querySelector('#turnLight1');
        const p2 = document.querySelector('#turnLight2');

        // let clicks = 0;
        // function countClicks(clicks) {
        //     if(clicks % 2 == 0){
        //     // socket.emit('p1green');
        //     // socket.emit('p2red');
        //     clicks += 1;
        //     console.log(clicks)
        //     //set p1 block green, p2 block red
        //     }else if(clicks % 2 == 1){
        //         // socket.emit('p2green');
        //         // socket.emit('p1red');
        //         clicks = 0;
        //         console.log(clicks)
        //         //set p2 block green, p1 block red
        //     };
        // };

        //let's send some events to the server to pass on.
        const box1 = document.querySelector('#block1');
        const box2 = document.querySelector('#block2');
        const box3 = document.querySelector('#block3');
        const box4 = document.querySelector('#block4');
        const box5 = document.querySelector('#block5');
        const box6 = document.querySelector('#block6');
        const box7 = document.querySelector('#block7');
        const box8 = document.querySelector('#block8');
        const box9 = document.querySelector('#block9');

        box1.addEventListener('click', (event) => {
            console.log('click')
            console.log('box 1')
            socket.emit('red1');
            socket.emit('countclick', 1)
        });
        box2.addEventListener('click', (event) => {
            console.log('click')
            socket.emit('red2');
            socket.emit('countclick')
        });
        box3.addEventListener('click', (event) => {
            console.log('click')
            socket.emit('red3');
            socket.emit('countclick')
        });
        box4.addEventListener('click', (event) => {
            console.log('click')
            socket.emit('red4');
            socket.emit('countclick')
        });
        box5.addEventListener('click', (event) => {
            console.log('click')
            socket.emit('red5');
            socket.emit('countclick')
        });
        box6.addEventListener('click', (event) => {
            console.log('click')
            socket.emit('red6');
            socket.emit('countclick')
        });
        box7.addEventListener('click', (event) => {
            console.log('click')
            socket.emit('red7');
            socket.emit('countclick')
        });
        box8.addEventListener('click', (event) => {
            console.log('click')
            socket.emit('red8');
            socket.emit('countclick');
        });
        box9.addEventListener('click', (event) => {
            console.log('click')
            socket.emit('red9');
            socket.emit('countclick')
        });


        socket.on('color_change1', (color) => {
            console.log('making cube red')
            let colorStr = 'rgb(' + color.r + ',' + color.g + ',' + color.b + ')';
            box1.setAttribute('material', 'color', colorStr);
        });
        socket.on('color_change2', (color) => {
            console.log('making cube red')
            let colorStr = 'rgb(' + color.r + ',' + color.g + ',' + color.b + ')';
            box2.setAttribute('material', 'color', colorStr);
        });
        socket.on('color_change3', (color) => {
            console.log('making cube red')
            let colorStr = 'rgb(' + color.r + ',' + color.g + ',' + color.b + ')';
            box3.setAttribute('material', 'color', colorStr);
        });
        socket.on('color_change4', (color) => {
            console.log('making cube red')
            let colorStr = 'rgb(' + color.r + ',' + color.g + ',' + color.b + ')';
            box4.setAttribute('material', 'color', colorStr);
        });
        socket.on('color_change5', (color) => {
            console.log('making cube red')
            let colorStr = 'rgb(' + color.r + ',' + color.g + ',' + color.b + ')';
            box5.setAttribute('material', 'color', colorStr);
        });
        socket.on('color_change6', (color) => {
            console.log('making cube red')
            let colorStr = 'rgb(' + color.r + ',' + color.g + ',' + color.b + ')';
            box6.setAttribute('material', 'color', colorStr);
        });
        socket.on('color_change7', (color) => {
            console.log('making cube red')
            let colorStr = 'rgb(' + color.r + ',' + color.g + ',' + color.b + ')';
            box7.setAttribute('material', 'color', colorStr);
        });
        socket.on('color_change8', (color) => {
            console.log('making cube red')
            let colorStr = 'rgb(' + color.r + ',' + color.g + ',' + color.b + ')';
            box8.setAttribute('material', 'color', colorStr);
        });
        socket.on('color_change9', (color) => {
            console.log('making cube red')
            let colorStr = 'rgb(' + color.r + ',' + color.g + ',' + color.b + ')';
            box9.setAttribute('material', 'color', colorStr);
        });

        const turnCheck = document.querySelector('#turnLight2');
        socket.on('p2turncheckred', (color) => {
            let colorStr = 'rgb(' + color.r + ',' + color.g + ',' + color.b + ')';
            turnCheck.setAttribute('material', 'color', colorStr);
        });

    </script>
</body>
</html>